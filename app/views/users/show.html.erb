<div id="user_container" class="container">
  <div id="user_row" class="row">
    <div id="user_info" class="col-xs-12 col-md-4">
      <div class="col-xs-2 hidden-md"></div>

      <div class="card col-xs-8 col-md-12">
        <div class="card-body text-center">
          <%= button_tag class: 'btn btn-link', data: {toggle: "modal", target: '#img_modal'} do %>
            <% if @user.user_image %>
              <%= image_tag(image_url(@user.user_image), id: 'user_image', alt: 'user image') %>
            <% else %>
              <%= image_tag(image_url('user_black_logo.jpg'), id: 'user_image', width: '200', height: '200') %>
            <% end %>
          <% end %>

          <div class="modal fade" id="img_modal" tabindex="-1" role="dialog" aria-labelledby="img_modal_label" aria-hidden="true">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="btn btn-secondary pull-right" data-dismiss="modal">Ã—</button>
                </div>
                <div class="modal-body">
                  <% if @user.user_image %>
                    <%= image_tag(image_url(@user.user_image), id: 'modal_user_image') %>
                  <% else %>
                    <%= image_tag(image_url('user_black_logo.jpg'), id: 'modal_user_image', width: '400', height: '400') %>
                  <% end %>
                </div>
              </div>
            </div>
          </div>

          <h2><%= @user.username %></h2>

          <% if current_user == @user %>
            <hr>
            <%= link_to t(:edit_profile), edit_user_path(@user) if current_user == @user %><br/>
            <%= link_to t(:delete_account), user_path, method: :delete, data: { confirm: t(:confirm_deletion) } %>
          <% end %>
        </div>
      </div>

      <div class="col-xs-2 hidden-md"></div>
    </div>

    <div id="user_charts" class="col-xs-12 col-md-8">
      <div class="col-xs-2 hidden-md"></div>

      <div class="col-xs-8 col-md-12">
        <div id="charts_header" class="text-center">
          <% if current_user == @user %>
            <%= link_to '<i class="fa fa-pencil"></i> '.html_safe + t(:new_chart),
              new_user_song_path(@user),
              class: 'btn btn-primary btn-sm',
              id: 'new_chart_button'
            %><br/>

            <p><%= @user.username + t(:user_charts) %></p>
          <% end %>
        </div>

        <%# TODO: Paginate %>
        <% if !@songs.empty? %>
          <div>
            <span style="margin-left: 5px"><%= t('activerecord.attributes.song.title') %></span>
            <span class="pull-right" style="margin-right: 5px;"><%= t('activerecord.attributes.song.key') %></span>
          </div>

          <ul class="list-group">
            <% @songs.each do |song| %>
              <% user = User.find(song.user_id) %>

              <%= link_to user_song_path(@user, song), id: 'user_songs', class: 'list-group-item' do %>
                <span><%= song.title%></span>

                <span class="pull-right">
                  <%= song.key %>
                  <%#= image_tag(user.user_image, id: 'user_image_thumbnail', class: 'user_thumbnail') %>
                  <%#= user.username %>
                </span>
              <% end %>


             <% end %>
          </ul>
        <% else %>
          <div class="panel panel-default">
            <div class="panel-body text-center">
              <h4><%= t(:no_charts) %></h4>
            </div>
          </div>
        <% end %>
      </div>

      <div class="song_pagination text-center">
        <%= paginate @songs %>
      </div>

      <div id="favorites_header">
        <p class="text-center"><%= @user.username + " favorited songs" %></p>

        <% if !@user.favorites.empty? %>
          <div>
            <span style="margin-left: 5px"><%= t('activerecord.attributes.song.title') %></span>
            <span class="pull-right" style="margin-right: 5px;"><%= t(:chart_made_by) %></span>
          </div>

          <ul class="list-group">
            <% @user.favorites.each do |favorite| %>
              <% song = Song.find(favorite.song_id) %>
              <% song_user = User.find(song.user_id) %>
              <%= link_to user_song_path(@user, song), class: 'list-group-item' do %>
                <span><%= song.title %></span>
                <span class="pull-right">
                  <%= image_tag song_user.user_image, class: 'user_thumbnail user_image_thumbnail' %>
                  <%= song_user.username %>
                </span>
              <% end %>
            <% end %>
          </ul>
        <% else %>
          <div class="panel panel-default">
            <div class="panel-body text-center">
              <h4>No favorites</h4>
            </div>
          </div>
        <% end %>
      </div>

      <div id="new_set_list_button_element" class="text-center">
        <% if current_user == @user %>
          <%= link_to "New Set List", new_user_set_list_path(@user), class: 'btn btn-primary', id: 'new_set_list_button' %>
        <% end %>
      </div>

      <div id="set_lists_card" class="card">
        <div id="set_lists_header" class="card-body">
          <p class="text-center"><%= @user.username + " Set Lists" %></p>

          <% if !@user.set_lists.empty? %>
            <ul class="list-group">
              <% @user.set_lists.each do |sl| %>
                <%= link_to sl.title, user_set_list_path(@user, sl), class: 'list-group-item text-center' %><br/>
              <% end %>
            </ul>


          <% else %>
            <div class="panel panel-default">
              <div class="panel-body text-center">
                <h4>No Set Lists</h4>
              </div>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>
</div>
